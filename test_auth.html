<!DOCTYPE html>
<html>

<head>
    <title>Authentication Test</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <h1>Authentication Test</h1>

    <div>
        <h2>Test Login</h2>
        <button onclick="testLogin()">Test Login with Demo Account</button>
        <div id="loginResult"></div>
    </div>

    <div>
        <h2>Test Signup</h2>
        <button onclick="testSignup()">Test Signup with New Account</button>
        <div id="signupResult"></div>
    </div>

    <div>
        <h2>Test API Health</h2>
        <button onclick="testHealth()">Test API Health</button>
        <div id="healthResult"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:5000/api';

        async function testHealth() {
            try {
                const response = await axios.get(`${API_BASE}/health`);
                document.getElementById('healthResult').innerHTML =
                    `<pre style="background: #e8f5e8; padding: 10px;">${JSON.stringify(response.data, null, 2)}</pre>`;
            } catch (error) {
                document.getElementById('healthResult').innerHTML =
                    `<pre style="background: #ffe8e8; padding: 10px;">Error: ${error.message}</pre>`;
            }
        }

        async function testLogin() {
            try {
                const response = await axios.post(`${API_BASE}/auth/login`, {
                    email: 'demo@example.com',
                    password: 'demo123'
                });

                document.getElementById('loginResult').innerHTML =
                    `<pre style="background: #e8f5e8; padding: 10px;">SUCCESS: ${JSON.stringify(response.data, null, 2)}</pre>`;

                // Store token for further tests
                if (response.data.data && response.data.data.token) {
                    localStorage.setItem('testToken', response.data.data.token);
                }
            } catch (error) {
                document.getElementById('loginResult').innerHTML =
                    `<pre style="background: #ffe8e8; padding: 10px;">Error: ${error.response?.data?.message || error.message}</pre>`;
            }
        }

        async function testSignup() {
            try {
                // Create a test form data
                const formData = new FormData();
                formData.append('name', 'Test User ' + Date.now());
                formData.append('email', 'test' + Date.now() + '@example.com');
                formData.append('password', 'test123');
                formData.append('panNumber', 'ABCDE1234F');

                const response = await axios.post(`${API_BASE}/auth/signup`, formData, {
                    headers: {
                        'Content-Type': 'multipart/form-data'
                    }
                });

                document.getElementById('signupResult').innerHTML =
                    `<pre style="background: #e8f5e8; padding: 10px;">SUCCESS: ${JSON.stringify(response.data, null, 2)}</pre>`;
            } catch (error) {
                document.getElementById('signupResult').innerHTML =
                    `<pre style="background: #ffe8e8; padding: 10px;">Error: ${error.response?.data?.message || error.message}</pre>`;
            }
        }

        // Test on page load
        window.onload = function () {
            testHealth();
        };
    </script>
</body>

</html>